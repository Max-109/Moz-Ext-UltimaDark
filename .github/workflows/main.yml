name: Automated XPI Builder
on: [push]

jobs: 
 build:
  runs-on: ubuntu-latest  
  steps: 
    - name: Checkout code 
      uses: actions/checkout@master

    - name: Automated XPI build process
      uses: TheDoctor0/zip-release@0.7.6
      with:

        filename: nightly-release.xpi
        type: 'zip'

        exclusions: '*.git* *.ps1* /*gre-resources/* /*other-tools-and-tests/* /*archive-worker-directory/* .editorconfig'
        directory: .
        path: .
    - name: Nightly-Alpha-Publish
      uses: docker://antonyurchenko/git-release:latest
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        UNRELEASED: "update"
        UNRELEASED_TAG: future
      with:
        args: |
            nightly-release.xpi

    - name: "Upload Artifact"
      uses: actions/upload-artifact@v3
      with:
        name: nightly-release.xpi
        path: ${{ steps.web-ext-build.outputs.target }}
